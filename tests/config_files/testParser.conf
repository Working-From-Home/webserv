server {
    listen 80;
    listen 127.0.0.1:81;

    root /var/www/app;
    index server1.php;

    error_page 497 	https://$host:443$request_uri;   #redirect  when 400 code error
    error_page 500 501 502 50x.html; 

    # try_files $uri $uri/ =404;
    location /{
        autoindex on;
    }

    location /media {
        root /var/www/media;
    }

    location .php$ {
        autoindex on;
        include fastcgi_params;
        fastcgi_pass wordpress:9000;
        fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }

}

server {
    listen 82;
    listen 83;

    error_page		497	https://$host:443$request_uri;   #redirect  when 400 code error
    

    root /var/www/app;
    index server2.php;
    autoindex on;

    location / {
        index server2Location.php;
        # try_files $uri $uri/ =404;
    }

    location \.php$ {
        autoindex off;
        include fastcgi_params;
        # fastcgi_intercept_errors on;
        fastcgi_pass rails:3000;
        fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param  SERVER_NAME        $server_name;
    }

}